网络根据 TCP/IP协议族分层来看：

| 分层   | 协议           |
| ------ | -------------- |
| 应用层 | HTTP、FTP、DNS |
| 传输层 | TCP、UDP       |
| 网络层 | IP             |
| 链路层 | ARP            |

ARP协议，负责把IP地址解析为MAC地址

##### TCP与UDP区别

TCP 是一种可靠传输，必须建立连接，可以进行大数据量的传输。

UDP 是一泓不可靠传输，不需要建立连接，但传输数据不能大于 64K。

TCP发送报文包含一些字段：

序号：Seq序号，占32位，用来标识从TCP源端向目的端发送的字节流

确认序号：Ack序号，占32位，只有ACK标志位为1时，确认序号字段才有效，Ack=Seq+1

SYN：发起一个新连接

FIN：释放一个连接

ACK：确认序号有效

##### TCP建立连接的三次握手

第一次：客户端请求建立连接，SYN=1 seq设置随机数x。客户端进入 SYN_SEND 状态

第二次：服务端响应，ACK=1 ack置为seq+1，同时发出建立连接请求，SYN=1 seq设置为随机数y。服务端进入SYN_RCVD 状态。

第三次：客户端响应，ACK=1 ack置为 seq+1，服务端检查 ACK =1 ack是否为K+1，如果正确，则正确建立连接，服务端客户端进入 ESTABLISHED 状态

##### TCP 四次挥手

第一次：客户端请求释放连接，FIN=1，seq设置随机数m，客户端进入 FIN_WAIT_1状态

第二次：服务端响应，ACK=1 ack置为m+1，服务端进入CLOSE_WAIT 状态，客户端接收到后进入 FIN_WAIT_2状态

第三次：服务端请求释放连接，FIN=1，seq设置随机数n，服务端进入 LAST_ACK状态

第四次：客户端响应，ACK=1ack置为n+1，客户端进入 TIME_WAIT状态，3MSL时间后关闭，服务端接收到进入 CLOSE 状态

##### HTTP 的报文结构

###### 请求报文

method path HTTP1.1

Head

Body

###### 响应报文

HTTP1.1 reponseCode reponseMessage

Body

##### responseCode含义

1xx：信息性状态码，接收的请求正在处理

2xx：成功状态码，请求正常处理完毕

3xx：重定向状态码，需要进行附加操作以完成请求

4xx：客户端错误状态码，服务器无法处理请求

5xx：服务器错误状态码，服务器处理请求出错

##### 对称加密和非对称加密

对称加密：同一个密钥可以同时用作信息的加密和解密。

非对称加密：私钥对信息加密，公钥对信息解密。

Hash：对信息进行hash 提取摘要，可以配合非对称加密做签名功能。

##### HTTPS 建立过程

1. 客户端生成一个 客户端随机数，并发送 http 给服务端 客户端随机数和客户端支持的对称加密算法，非对称加密算法，hash算法

2. 服务端生成一个服务端随机数，并发送 http 给客户端 服务端随机书和最后确定的对称加密算法，非对称加密算法，hash算法

3. 服务端通过 http 发送证书给客户端，证书中包含服务端非对称加密公钥
4. 客户端接收到证书后，通过保存在系统中的根证书验证服务端证书的合法性，验证通过后，客户端生成 pre-Master Secret 然后利用服务端非对称加密公钥对其加密，发送 http 给服务端。然后两端利用 pre-Master Secret、客户端随机数、服务端随机数是生成 Master Secret。再根据 Master Secret 生成 客户端对称加密密钥、服务端对称加密密钥、客户端MAC Secret、服务端MAC Secret
5. 客户端 http 通知服务端接下来使用对称加密通信
6. 客户端 http 使用 客户端对称加密密钥对内容加密通信 发送 Finish消息，并使用客户端MAC Secret对之前所有通信内容hash
7. 服务端 http 通知客户端接下来使用对称加密通信
8. 服务端 http 使用 服务端对称加密密钥对内容加密通信 发送 Finish消息，并使用服务端MAC Secret对之前所有通信内容hash